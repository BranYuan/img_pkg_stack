# _*_ coding: UTF-8 _*_
import numpy as np
import cv2

# 双目相机参数

'''
matrix_l = np.array([[1489.242904, 0.0, 731.798449],
                     [0.0, 1489.679715, 498.313435],
                     [0.0, 0.0, 1.0]])
distortion_l =np.array([[0.376035, -1.342516, -0.002434, 0.002246, 0.0]])

matrix_r = np.array([[1567.768604, 0.0, 818.487612],
                     [0.0, 1554.291388, 551.497797],
                     [0.0, 0.0, 1.0]])
distortion_r =np.array([[0.239838, -0.230651, 0.025008, 0.047352, 0.0]])
R = np.array([ [0.9980398415062943, -0.0067615460929746464, -0.06221540211654574], 
               [0.002619490940031377, 0.9977884337557856, -0.06641821836206806], 
               [0.06252689847822294, 0.06612505544503415, 0.9958503220911691]])
T = np.array([-0.12313331435252275, -0.0022000997597344325, 0.008878582222738955])
'''
matrix_l = np.array([[1489.242904, 0.0, 731.798449],
                     [0.0, 1489.679715, 498.313435],
                     [0.0, 0.0, 1.0]])
distortion_l =np.array([[0.376035, -1.342516, -0.002434, 0.002246, 0.0]])

matrix_r = np.array([[1567.768604, 0.0, 818.487612],
                     [0.0, 1554.291388, 551.497797],
                     [0.0, 0.0, 1.0]])
distortion_r =np.array([[0.239838, -0.230651, 0.025008, 0.047352, 0.0]])
R = np.array([ [0.9980398415062943, -0.0067615460929746464, -0.06221540211654574], 
               [0.002619490940031377, 0.9977884337557856, -0.06641821836206806], 
               [0.06252689847822294, 0.06612505544503415, 0.9958503220911691]])
T = np.array([-0.12313331435252275, -0.0022000997597344325, 0.008878582222738955])
f_l = matrix_l[1][1]    # 焦距
B = T[0]    # 基线距离
size = (1280, 960)
R1, R2, P1, P2, Q, validPixROI1, validPixROI2 = cv2.stereoRectify(matrix_l, distortion_l, matrix_r, distortion_r, size, R=R, T=T)
left_map1, left_map2 = cv2.initUndistortRectifyMap(matrix_l, distortion_l, R1, P1, size, cv2.CV_16SC2)
right_map1, right_map2 = cv2.initUndistortRectifyMap(matrix_r, distortion_r, R2, P2, size, cv2.CV_16SC2)
print f_l, B
